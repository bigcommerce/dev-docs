# Troubleshooting BigCommerce for WordPress Plugin



## Error on "Add to Cart" button, 404 error

### Symptom

```shell
 Not Found: The requested URL /bigcommerce/cart/42 was not found on this server.
 Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.
```

### Solution

In WordPress, go to **Settings > Permalinks**. Scroll to the bottom of the page and click Save. This resets the site's redirects.

## PHP getenv() Errors

### Symptom

When in use the plugin floods the error log with the following:

```shell
PHP message: PHP Warning: getenv() expects exactly 1 parameter, 2 given in wp-content/plugins/bigcommerce-for-wordpress-0.11.1/bigcommerce.php on line 58
```

### Solution

You can expect to see that error if you're on PHP version 5.4 or lower (the plugin requires 5.6+).

## 403 error on API request

### Symptom

```shell
[429] Error connecting to the API (https://api.bigcommerce.com/stores/hash/v3/catalog/categories?id%3Ain=138%2C139%2C140%2C142%2C143%2C144%2C145%2C146%2C147%2C149&limit=10&include_fields=id)
```

### Solution

Make sure that the server/service doesn't block requests. Whitelist requests to BigCommerce API and responses from it.


## Could not retrieve the token

### Symptom

```shell
BigCommerce.ERROR: Could not retrieve the token
{
  "trace": "
    #0 /path/wp-content/plugins/bigcommerce/src/BigCommerce/GraphQL/BaseGQL.php(150): BigCommerce\\GraphQL\\BaseGQL->parse_response(Array)
    #1 /path/wp-content/plugins/bigcommerce/src/BigCommerce/GraphQL/BaseGQL.php(111): BigCommerce\\GraphQL\\BaseGQL->make_request('{\"channel_id\":1...', Array, 'https://api.big...')
    #2 /path/wp-content/plugins/bigcommerce/src/BigCommerce/GraphQL/BaseGQL.php(57): BigCommerce\\GraphQL\\BaseGQL->request_token()
    #3 /path/wp-content/plugins/bigcommerce/src/BigCommerce/GraphQL/BaseGQL.php(32): BigCommerce\\GraphQL\\BaseGQL->get_token()
    #4 /path/wp-content/plugins/bigcommerce/src/BigCommerce/GraphQL/GraphQL_Processor.php(14): BigCommerce\\GraphQL\\BaseGQL->__construct(Object(BigCommerce\\Api\\Configuration))
    #5 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Container/GraphQL.php(35): BigCommerce\\GraphQL\\GraphQL_Processor->__construct(Object(BigCommerce\\Api\\Configuration), Array)
    #6 /path/wp-content/plugins/bigcommerce/vendor/pimple/pimple/src/Pimple/Container.php(118): BigCommerce\\Container\\GraphQL->BigCommerce\\Container\\{closure}(Object(Pimple\\Container))
    #7 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Container/Import.php(195): Pimple\\Container->offsetGet('bigcommerce.gra...')
    #8 /path/wp-content/plugins/bigcommerce/vendor/pimple/pimple/src/Pimple/Container.php(118): BigCommerce\\Container\\Import->BigCommerce\\Container\\{closure}(Object(Pimple\\Container))
    #9 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Container/Import.php(294): Pimple\\Container->offsetGet('import.categori...')
    #10 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Import/Task_Manager.php(97): BigCommerce\\Container\\Import->BigCommerce\\Container\\{closure}('purged_brands')
    #11 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Container/Import.php(369): BigCommerce\\Import\\Task_Manager->run_next('purged_brands')
    #12 /path/wp-includes/class-wp-hook.php(308): BigCommerce\\Container\\Import->BigCommerce\\Container\\{closure}('purged_brands')
    #13 /path/wp-includes/class-wp-hook.php(332): WP_Hook->apply_filters(NULL, Array)
    #14 /path/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
    #15 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Import/Runner/Cron_Runner.php(53): do_action('bigcommerce/imp...', 'purged_brands')
    #16 /path/wp-content/plugins/bigcommerce/src/BigCommerce/Container/Import.php(132): BigCommerce\\Import\\Runner\\Cron_Runner->continue_import()
    #17 /path/wp-includes/class-wp-hook.php(306): BigCommerce\\Container\\Import->BigCommerce\\Container\\{closure}()
    #18 /path/wp-includes/class-wp-hook.php(332): WP_Hook->apply_filters('', Array)
    #19 /path/wp-includes/plugin.php(565): WP_Hook->do_action(Array)
    #20 /path/wp-cron.php(188): do_action_ref_array('bigcommerce_con...', Array)
    #21 {main}"
}
```

### Solution

If you use `Fast`(headless) import you need to apply the right scopes to your API keys. The Storefront API tokens and Storefront API impersonation token scopes are required. You can create correct scopes in the Bigcommerce dashboard > Settings > Store-level API accounts

## Mini-cart/cart page doesn't display or display wrong amount of products

### Solution

Make sure that you don't have a cache problem. Each time you add a product to a cart, an API request is sent. Without a cache set, the cart's content will be updated after the successful processing of the API request. However, if cache rules are applied they can affect the cart and return the wrong version of the cart (empty cart page, not a sufficient amount of products, etc.). To resolve the problem exclude cart page and mini-cart requests from cache.

## Sync stuck. No handler found for current import state

### Symptom

```shell
BigCommerce.NOTICE: No handler found for current import state {"state":"completed"}
```

### Solution

Go to `wp-admin > BigCommerce > Settings > Diagnostics`. Click on the Abort import button and wait one to two minutes. After that try to restart the import. Check that WP-Cron is working and you don't have server issues. If import still doesn't work, contact BigCommerce support and/or create an issue in the [GitHub repository](https://github.com/bigcommerce/bigcommerce-for-wordpress/issues). Provide as many details as possible.



## PHP errors in server logs related to the plugin

### Symptom

```shell
PHP Fatal error:  Uncaught Error: Call to undefined function BigCommerce\Import\Importers\Products\ctype_alpha() in path/wp-content/plugins/bigcommerce/src/BigCommerce/Import/Importers/Products/Product_Builder.php:461 
```

### Solution

Check that this is not a PHP extension specific issue, e.g https://www.php.net/manual/en/function.ctype-alpha.php ,function is disabled by hosting/service provider and similar. In any other instances, contact BigCommerce support and/or create an issue in the [GitHub repository](https://github.com/bigcommerce/bigcommerce-for-wordpress/issues).

## Not all products from the BigCommerce store appear on WordPress side

### Solution

Check that products are assigned to corresponding channels. Make sure that for Full import in plugin settings you didn't disable `Automatic Listing` option.

## Import is too slow

### Solution

Import time relies on the amount of product that you have synced from your catalog. In general if you have more than 200 products and use full import it is normal to run import for more than 30 minutes. Note that the import process also relies on WP-Cron. That means that import tasks will be processed only when the site has visitors. The import task won't be processed automatically until someone is on the site. To avoid such a problem, [Server Side Cron](https://developer.bigcommerce.com/bigcommerce-for-wordpress/extending-the-plugin/creating-reliable-cron-jobs#using-server-cron-to-enhance-wp-cron) can be used.

## Inactive channel. Product import canceled

### Symptom

```shell
[502] Error connecting to the API (https://api.bigcommerce.com/stores/hash/v3/channels/channel_id/listings)
[504] Error connecting to the API (https://api.bigcommerce.com/stores/hash/v3/channels/channel_id/listings/listing_id)
```

### Solution

Make sure that your WordPress store is connected to BigCommerce and the primary channel is set under `BigCommerce > Settings > Channel`. If primary channel is not set then re-install plugin and connect it to the correct store channel.

## Webhooks incorrect password

### Symptom

```shell
BigCommerce-webhooks.ERROR: Incoming webhook password does not match
```

### Solution

Go to `BigCommerce > Settings > Product Sync`. Disable webhooks and save settings. After page reload go to the `BigCommerce > Settings > Product Sync` again and re-enable webhooks.

## Cart/Checkout url doesn't work or throw 404 error

### Solution
Make sure that the correct permalink structure is set in `wp-admin > Settings > Permalinks`. For correct plugin work enable any permalink structure except a plain one.

## Password reset email doesn't work

### Solution

Check that email functionality is on and your server/service doesn't block it. By default plugin use settings from WordPress.

## Some elements are hidden on product single page(reviews, price, variants etc)

### Solution

Check your primary channel settings in BigCommerce (example url: `https://store-<store_hash>.mybigcommerce.com/manage/channel/<channel_id>/store-settings`) and make sure that corresponding items in product display settings are not hidden.

## Product entity exists. Skipping

### Symptom

```shell
BigCommerce.DEBUG: Product entity exists. Skipping. {"product_id":xxxx,"channel_id":"xxxxx"} []
```

### Solution

Message in error logs means product already imported to WordPress and won't be processed again

## Failed to download image. cURL error 28: Resolving timed out after 10000 milliseconds

### Symptom

```shell
BigCommerce.NOTICE: Failed to download image {"url":"https://cdn11.bigcommerce.com/s-hash/products/18id20/images/id/hps_bottle__13339.1611096484.1280.1280.png?c=2","error":["cURL error 28: Resolving timed out after 10000 milliseconds"]} []
```

### Solution

Issue occurs during product/category image import. The issue is environment specific and can be caused by the server itself. Possible reasons for the issue:

1. Network/Firewall settings - outgoing requests can be blocked by it
2. DNS failure
3. Server limits e.g some proxy set on server and it has its own timeout limit
4. Security modules(Mod_Security) may block requests
5. Server is trying to resolve bigcommerce.com domain via IPv6 instead of IPv4

## E-commerce pages(categories, products single page, checkout) are not visible for non-logged user

### Solution
Make sure that your channel attached to WordPress is not in pre launch status. If it has prelaunch status change it to active and perform import on WordPress side

## New/Updated since last sync doesn't work on Fast import

### Solution

The "Fast Headless" import doesn't support "New/Updated since last sync"(partial) option. The fast import will retrieve only categories, brands, product ids. All other information will be taken on fly when you load corresponding front page

## What scopes are correct for full functionality

### Solution

The full list of the scopes can be found [here](https://developer.bigcommerce.com/bigcommerce-for-wordpress/setup/multisite#api-account-name-field).

## Products are not updated after import

### Solution

Flush the cache on your WordPress setup. Sometimes pages, product information may be cached and old information will be shown.

## Price is not correct on the single product page (Fast Import)

### Solution

Sometimes due to heavy caching, the price on the product page has the wrong value. That happened due to an expired `X-Nonce` for price request. The issue can be resolved by removing that nonce from the price request. Go to the `Appearance > Customizer > BigCommerce > Product Single > Pricing nonce field(for advanced use only)` and disable nonce.

