# Scripts API

The BigCommerce Scripts API gives developers the ability to deploy scripts on store pages programmatically, without including it in a Stencil theme or pasting a snippet of code into the control panel manually. You can insert many types of scripts using this API, including the following:

* Analytics scripts
* Single-click app scripts
* Live chat and support plugins
* Theme extensions or connector apps

After a merchant installs your app, the app can freely update its scripts. If desired, you can automatically remove scripts when a merchant uninstalls your app.

>>>> diataxis type(s)

This article contains detailed information about the Scripts API and assumes you're familiar with the BigCommerce App Installation process. For more information on the app installation process from the merchant perspective, see our Help Center article on [Installing Apps](https://support.bigcommerce.com/s/article/How-do-I-access-and-install-the-new-single-click-apps-within-my-Bigcommerce-store-control-panel?language=en_US#installing). For information on responding to app installation callbacks, see our article on [Implementing OAuth](/api-docs/apps/guide/auth).


## Transitioning your app

If your app is already live, you may have previously asked merchants to paste a code snippet into one of these two sections in the control panel:

- Footer Scripts
- Web Analytics

Because our older Blueprint-based themes do not support the Scripts API, your app still needs some way of providing users of older themes the information they need to get started, without burdening users of Stencil or headless storefronts with additional unnecessary steps.

To ease your app's transition to using the Scripts API, we recommend one or more of the following strategies, depending on your app's ecosystem and customer base. 

### Stencil vs Blueprint

Storefront-wise, newer stores have access to Stencil themes and headless frontends. In addition to those two frameworks, older stores may use our legacy theme engine, Blueprint, which cannot render scripts inserted using the Scripts API.

Because of this, you’ll need to check whether a user is running Stencil to determine if their store supports the Scripts API. To do this, use the [Get Store Information API](/api/v2/#store-information-reference) endpoint and check the `stencil_enabled` flag. (requires [store_v2_information_read_only scope](/api/#oauth-scopes)).

## Upgrades and installation

### Installing an app on Stencil

We recommend inserting your scripts immediately after receiving the POST response during the Auth Callback flow for apps installed on Stencil stores. Add your scripts using the Create Script endpoint of the Scripts API.

We highly recommend leaving the `auto_uninstall` flag set to true, so that your app will properly clean itself up when uninstalled. Find more information about this flag <a href="#script_object-properties">here</a>.


#### Upgrading existing apps on Stencil

If you already released your app, you may have existing users with pasted-in code somewhere in their control panel. There are a few possible ways to deal with this situation.

__Do nothing__


If you don’t need to upgrade existing merchants to the Scripts API, it’s perfectly fine to leave them. You’ll need to maintain documentation for the manual uninstallation process so that merchants with older installations know what to clean up. You won’t be able to update or add scripts for these users automatically. 

 __Prompt merchants to upgrade__


If you want your merchants to update to the new Script Manager over time, you can prompt them to do so on your app’s landing page. You’ll need to keep track of which of your merchants are not using the Script Manager to know whether you need to display this prompt. Use the [Get Store Information](/api-reference/store-management/store-information-api/store-information/getstore) endpoint to make sure they are running Stencil before prompting them to upgrade.

Once a user decides to upgrade, you can walk them through removing the old pasted-in code in their control panel, and then, once the merchant clicks a button, install your scripts through the Scripts API.

__Silently upgrade to the Scripts API__


Finally, suppose your old, pasted-in scripts can live alongside the new Scripts API scripts. In that case, you may be able to upgrade to using the Scripts API without any user intervention required. Whether or not this is possible will vary depending on the implementation of your app.

While your merchants will be loading more data on their storefront pages than necessary, this method will allow you to transition to using the Scripts API for all of your installations immediately. Keep in mind you’ll still need to document the manual uninstallation process for existing installations.

### Installing apps on Blueprint stores 

As mentioned, the Blueprint theme engine does not support the Scripts API. You will not be able to render any scripts inserted through this API on any storefront pages. To prevent unpredictable behavior, should a user change their theme, we highly recommend checking the Get Store Information endpoint for Stencil support before installing any scripts through the Scripts API. Additionally, you’ll still want to show the old manual installation steps when a store does not support Stencil. 

### Existing Blueprint installations 

Existing blueprint installations won’t be affected, but remember that if you prompt existing Stencil users to upgrade to the Script Manager, you’ll want to suppress this message for Blueprint users. 

### Fixing missing scripts

It’s possible that your app installation may find itself unexpectedly missing one or more scripts. Below are some possible causes of this issue.

1.) __The merchant deleted your script__ 

Merchants receive a warning when attempting to delete a script belonging to an app, but we do allow them to do so.

To handle this situation gracefully, we recommend you check the [Get Scripts](/docs/rest-management/scripts#get-all-scripts) endpoint on your App Detail Page (returned by the [Load Callback URI](/api-docs/getting-started/building-apps-bigcommerce/building-apps#building-apps_processing-signed-payload) to determine whether the expected scripts are present. If they are not, you can prompt the user to click a button to repair their installation automatically.

We ask that you request the user’s permission rather than doing this automatically, as they may have had a good reason for deleting the missing script. 

2.) __The merchant's theme is not set up correctly__ 

The theme templates must have the handlebars expressions `{{head.scripts}}` and `{{footer.scripts}}` in the pages to render scripts. If either of these is absent, scripts on that page with location set to head or footer (respectively) will not render correctly.

Of particular note, `{{head.scripts}}` was only recently added to the checkout and order confirmation pages in our Cornerstone theme, and widespread adoption of this standard outside of Cornerstone is still an ongoing process.

To ensure your app is compatible with as many themes as possible, we recommend footer overhead for checkout, order_confirmation, and all_pages visibilities. 

3.) __Scripts are not rendering in the checkout and order confirmation__ 

To render scripts, the store must have BigCommerce’s Optimized one-page checkout enabled. This is the default checkout type for all new Stencil stores. Existing stores have to change the checkout type as detailed in this article manually. 

Stencil themes from the marketplace support the [Optimized One-Page Checkout](https://support.bigcommerce.com/articles/Public/Optimized-Single-Page-Checkout#signup). However, there could be instances where the merchant maintains their private theme without the ability to support the optimized one-page checkout. In this case, the merchant must add the theme support, following the [one-page checkout steps](/stencil-docs/customizing-checkout/optimized-one-page-checkout).  

## Notes

- If you are injecting scripts into the checkout, you will need to use the Checkout Content OAuth scope. For more about API accounts and OAuth scopes, see the [Guide to API Accounts](/api-docs/getting-started/authentication/rest-api-authentication).
- Merchants can see the scripts installed on the store in the control panel. Within the native tag manager, merchant actions are limited to viewing and deleting a script.
- Scripts can be located in the header `{{head.scripts}}` or footer `{{footer.scripts}}`.
- Scripts Manager is only for Stencil themes. Blueprint store users will still need to copy and paste in code.
- The current visibility options are `storefront`, `checkout`, `all_pages`, and `order_confirmation`.
- Scripts injected with the Scripts API will not render when you are developing a theme locally using Stencil CLI.
- Each app can have 10 scripts. 
- You can install up to five scripts in a single call. 

```html filename="Example scripts" showLineNumbers copy
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_TRACKING_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GA_TRACKING_ID');
</script>
```

## Script visibility locations

| Scope | Visibility |
| -- | -- |
| `all_pages` | Add Wishlist <br /> Blog List <br /> Blog Post<br /> Brand Pages <br /> All Brands Page <br /> Cart <br /> Category <br /> Checkout <br /> My Account <br /> Product Compare <br /> Order Confirmation <br /> Page <br /> Payment Methods<br /> Login <br /> Contact Form <br /> Product <br /> Search <br /> All Wishlist <br /> Wish List <br /> 404 page |
| `storefront` |  Add Wishlist <br /> Blog List <br /> Blog Post<br /> Brand Pages <br /> All Brands Page <br /> Cart <br /> Category <br /> Product Compare <br /> Page <br /> Contact Form <br /> Product <br /> Search <br /> All Wishlist <br /> Wish List <br /> 404 page|
| `checkout` | Checkout | 
| `order_confirmation` | Order Confirmation | 

Scripts can not be injected to:
- giftcertificates.php
- sitemap.php

## Related resources

### Endpoints
* [Scripts](/docs/rest-management/scripts)
